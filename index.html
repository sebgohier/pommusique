<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>POM Musique - Espace Prof</title>
  <style>
    body { font-family: Arial, sans-serif; display: flex; margin: 0; height: 100vh; }
    #menu {
      width: 220px; background: #2c3e50; color: #fff; padding: 20px; box-sizing: border-box;
    }
    #menu h3 { margin-top: 0; font-size: 18px; text-align: center; }
    #menu button {
      display: block; margin-bottom: 15px; width: 100%; padding: 10px;
      cursor: pointer; border: none; border-radius: 5px; font-size: 14px;
      background-color: #34495e; color: #fff; transition: background 0.2s;
    }
    #menu button:hover { background-color: #1abc9c; }
    #content { flex: 1; padding: 30px; overflow-y: auto; background: #ecf0f1; }
    h2 { margin-top: 0; color: #2c3e50; }
    label { display: block; margin-top: 12px; font-weight: bold; }
    input, select { padding: 6px; margin-top: 5px; width: 280px; border-radius: 3px; border: 1px solid #ccc; }
    button.send {
      margin-top: 20px; padding: 10px 25px; cursor: pointer;
      background-color: #1abc9c; color: #fff; border: none; border-radius: 5px; font-size: 15px;
    }
    button.send:hover { background-color: #16a085; }
    #message_hs, #message_abs { margin-top: 15px; font-weight: bold; }
    .form-section { display: none; background: #fff; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
  </style>
</head>
<body>

<div id="menu">
  <h3>Menu Professeur</h3>
  <button onclick="showSection('repertoire')">Répertoire élèves</button>
  <button onclick="showSection('heuresSup')">Heures Supplémentaires</button>
  <button onclick="showSection('absences')">Demande d'Absence</button>
</div>

<div id="content">

  <!-- Répertoire élèves -->
  <div id="repertoire" class="form-section">
    <h2>Répertoire élèves Séb 2025/2026</h2>
    <p>Affichage du répertoire ou liens vers documents si nécessaire.</p>
  </div>

  <!-- Heures Supplémentaires -->
  <div id="heuresSup" class="form-section">
    <h2>Heures Supplémentaires</h2>
    <label>Date :</label><input type="date" id="dateHS" name="dateHS">
    <label>Type :</label>
    <select id="typeHS" name="typeHS">
      <option value="Concert">Concert</option>
      <option value="Répétition">Répétition</option>
      <option value="Autre">Autre</option>
    </select>
    <label>Heure début :</label><input type="time" id="heureDebutHS" name="heureDebutHS">
    <label>Heure fin :</label><input type="time" id="heureFinHS" name="heureFinHS">
    <label>Lieu :</label><input type="text" id="lieuHS" name="lieuHS" placeholder="Salle">
    <button class="send" onclick="envoyerHeuresSup()">Envoyer la demande</button>
    <div id="message_hs"></div>
  </div>

  <!-- Demande d'Absence -->
  <div id="absences" class="form-section">
    <h2>Demande d'Autorisation d'Absence</h2>
    <label>Date d'absence :</label><input type="date" id="dateAbsence" name="dateAbsence">
    <label>Créneau horaire :</label><input type="text" id="creneauAbsence" name="creneauAbsence" placeholder="09h30-11h00">
    <label>Date de rattrapage :</label><input type="date" id="dateRattrapage" name="dateRattrapage">
    <label>Créneau de rattrapage :</label><input type="text" id="creneauRattrapage" name="creneauRattrapage" placeholder="14h00-15h30">
    <label>Salle :</label><input type="text" id="salle" name="salle" placeholder="Salle des artistes">
    <label>Accord élèves/responsables :</label><input type="checkbox" id="accord" name="accord">
    <button class="send" onclick="envoyerAbsence()">Envoyer la demande</button>
    <div id="message_abs"></div>
  </div>

</div>

<script>
  const URL_HEURES_SUP = "https://script.google.com/macros/s/AKfycbzy91QR2q1I6qkSvRC894ZyLodIsIAoydV3NleFoKVHrSdj38BlmGTAAwVpYeNDuxLmCQ/exec";
  const URL_ABSENCES = "https://script.google.com/macros/s/AKfycbzy91QR2q1I6qkSvRC894ZyLodIsIAoydV3NleFoKVHrSdj38BlmGTAAwVpYeNDuxLmCQ/exec";

  function showSection(sectionId) {
    document.querySelectorAll('.form-section').forEach(div => div.style.display = 'none');
    document.getElementById(sectionId).style.display = 'block';
  }

  function envoyerHeuresSup() {
    const data = {
      dateHS: document.getElementById("dateHS").value,
      typeHS: document.getElementById("typeHS").value,
      heureDebutHS: document.getElementById("heureDebutHS").value,
      heureFinHS: document.getElementById("heureFinHS").value,
      lieuHS: document.getElementById("lieuHS").value
    };

    fetch(URL_HEURES_SUP, { method: "POST", body: JSON.stringify(data) })
      .then(res => res.json())
      .then(json => {
        const msg = document.getElementById("message_hs");
        if(json.status === "success") {
          msg.style.color = "green";
          msg.textContent = json.message;
          document.getElementById("dateHS").value = "";
          document.getElementById("typeHS").value = "Concert";
          document.getElementById("heureDebutHS").value = "";
          document.getElementById("heureFinHS").value = "";
          document.getElementById("lieuHS").value = "";
        } else {
          msg.style.color = "red";
          msg.textContent = "Erreur : " + json.message;
        }
      })
      .catch(err => {
        const msg = document.getElementById("message_hs");
        msg.style.color = "red";
        msg.textContent = "Erreur réseau : " + err;
      });
  }

  function envoyerAbsence() {
    const data = {
      dateAbsence: document.getElementById("dateAbsence").value,
      creneauAbsence: document.getElementById("creneauAbsence").value,
      dateRattrapage: document.getElementById("dateRattrapage").value,
      creneauRattrapage: document.getElementById("creneauRattrapage").value,
      salle: document.getElementById("salle").value,
      accord: document.getElementById("accord").checked
    };

    fetch(URL_ABSENCES, { method: "POST", body: JSON.stringify(data) })
      .then(res => res.json())
      .then(json => {
        const msg = document.getElementById("message_abs");
        if(json.status === "success") {
          msg.style.color = "green";
          msg.textContent = json.message;
          document.getElementById("dateAbsence").value = "";
          document.getElementById("creneauAbsence").value = "";
          document.getElementById("dateRattrapage").value = "";
          document.getElementById("creneauRattrapage").value = "";
          document.getElementById("salle").value = "";
          document.getElementById("accord").checked = false;
        } else {
          msg.style.color = "red";
          msg.textContent = "Erreur : " + json.message;
        }
      })
      .catch(err => {
        const msg = document.getElementById("message_abs");
        msg.style.color = "red";
        msg.textContent = "Erreur réseau : " + err;
      });
  }

  // Affiche par défaut la section Répertoire
  showSection('repertoire');
</script>

</body>
</html>
