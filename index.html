<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">

<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Interface Professeur - POM Musique</title>
<meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src https://script.google.com https://script.googleusercontent.com; img-src https://raw.githubusercontent.com 'self'; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval';">

  <!-- Lien vers le manifest PWA -->
  <link rel="manifest" href="manifest.json">


<style>
body { margin:0; font-family:Arial,sans-serif; display:flex; height:100vh; }
.sidebar { width:220px; background: linear-gradient(to bottom,#ffb629,#000000); color:white; display:flex; flex-direction:column; align-items:center; padding-top:20px; }
.sidebar img { width:150px; margin-bottom:30px; }
.menu-item { width:90%; padding:12px 10px; margin:5px 0; border-radius:8px; cursor:pointer; display:flex; align-items:center; transition: background 0.3s; font-size:16px; background-color:#ccc; color:#000; }
.menu-item:hover { background-color:#bbb; }
.menu-item span { margin-left:10px; }
.content { flex:1; padding:20px; background-color:#f9f9f9; overflow-y:auto; }
.section { 
  display:none;
  width: 100%;         
  box-sizing: border-box;
  padding-top: 20px;  
}

input, select {
  width: 100%;
  box-sizing: border-box;
  padding: 4px;
  margin: 8px 0 4px 0;
}

/* Boutons */
button {
  padding: 6px 12px;
  margin-top: 5px;
  cursor: pointer;
}

/* Tables */
table {
  border-collapse: collapse;
  width: 100%;
  margin-top: 10px;
}

/* Cellules */
th, td {
  border: 1px solid #000;
  padding: 6px;
  text-align: center;
}

/* Header table */
th {
  background-color: #f0f0f0;
}

/* ============================= */
/* ===== PARTITIONS ===== */
/* ============================= */

/* =======================
   Morceaux
   ======================= */
.morceau {
  cursor: pointer;
  padding: 10px 14px;
  margin-bottom: 6px;
  background: #eee;
  border-radius: 6px;
  /* on retire le font-weight ici pour g√©rer s√©par√©ment groupe/titre */
}

.morceau:hover {
  background: #ddd;
}

/* Titre du morceau : nom du groupe en gras, titre en italique */
.morceauTitre {
  font-size: 16px; /* optionnel, pour lisibilit√© */
}

.morceauTitre .groupe {
  font-weight: bold; /* gras pour le nom du groupe */
}

.morceauTitre .titre {
  font-style: italic; /* italique pour le titre du morceau */
  font-weight: normal; /* retire le gras h√©rit√© */
}

/* =======================
   Contenu du morceau
   ======================= */
.morceauContent {
  display: none;
  margin-left: 15px;  /* petit d√©calage pour hi√©rarchie */
  margin-top: 6px;
  padding: 8px 12px;
  background: #f9f9f9;
  border-radius: 5px;
  box-shadow: 0 1px 3px rgba(0,0,0,0.1);
}

/* =======================
   Onglets
   ======================= */
.onglets {
  margin-bottom: 12px;
}

.onglets button {
  padding: 6px 12px;
  margin-right: 8px;
  cursor: pointer;
  border: none;
  border-radius: 4px;
  background: #ddd;
}

.onglets button.active {
  background: #f39c12;
  color: white;
}

/* =======================
   Fichiers (PDF / audio)
   ======================= */
.fichier {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  background: #f9f9f9;
  padding: 6px 12px;
  border-radius: 5px;
  margin-bottom: 6px;
  margin-left: 20px; /* hi√©rarchie instruments */
  transition: background 0.2s;
}

.fichier:hover {
  background: #eee;
}

.fichier span {
  min-width: 140px; /* espace pour nom instrument */
}

.fichier button {
  flex-shrink: 0;
  margin-left: 20px;
  padding: 4px 8px;
}

/* =======================
   D√©calage suppl√©mentaire pour onglets
   ======================= */
.partitionsOnglet, .audiosOnglet {
  margin-left: 10px; /* d√©cale un peu par rapport au bloc morceau */
}

/* =======================
   Sidebar (images)
   ======================= */
.sidebar img {
  cursor: pointer; /* main au survol */
  transition: transform 0.2s; /* effet l√©ger au survol */
}

.sidebar img:hover {
  transform: scale(1.05); /* l√©ger zoom au survol */
}

.doc-buttons {
  display: flex;
  flex-wrap: wrap;
  gap: 15px;
  margin-top: 20px;
}

.btn-doc {
  background-color: #ffb629;
  color: #000;
  padding: 10px 20px;
  text-decoration: none;
  font-weight: bold;
  border-radius: 8px;
  transition: transform 0.2s, box-shadow 0.2s;
}

.btn-doc:hover {
  transform: translateY(-2px);
  box-shadow: 0 4px 10px rgba(0,0,0,0.2);
}






</style>


</head>
<body>

<div class="sidebar">
<img src="https://raw.githubusercontent.com/sebgohier/pommusique/refs/heads/main/Logo%20Pom%20Musique%20noir.png" alt="Logo POM Musique">
<div class="menu-item" onclick="showSection('sectionRepertoire')">üìÅ <span>R√©pertoire √©l√®ves</span></div>
<div class="menu-item" onclick="showSection('planning')">üìÖ <span>Planning</span></div>
<div class="menu-item" onclick="showSection('heuresSup')">‚è∞ <span>Heures suppl√©mentaires</span></div>
<div class="menu-item" onclick="showSection('absences')">üìù <span>Absences</span></div>
<div class="menu-item" onclick="showSection('partitions')">üéº <span>Partitions</span></div>
 <div class="menu-item" onclick="showSection('contacts'); loadContacts()">üìû <span>Contacts</span></div>
<div class="menu-item" onclick="showSection('documentsUtiles')">üìë <span>Documents utiles</span></div>
</div>

<div class="content">

  <!-- SECTION ACCUEIL -->
<div class="section" id="accueil" style="display:flex; flex-direction:column; align-items:center;">
  <div id="accueilMessage" style="
      flex:1;
      display:flex;
      justify-content:center;
      align-items:center;
      text-align:center;
      font-size:20px;
      color:#555;
      padding:20px;
  ">
    Bienvenue sur l‚Äôinterface POM Musique !<br>
    Veuillez choisir votre nom dans la liste ci-dessous pour acc√©der aux sections.
  </div>

  <!-- Wrapper pour le select du prof -->
  <div id="profSelectorWrapper" style="margin-top:20px; text-align:center;">
    <label for="selectProfGlobal" style="font-weight:bold;">Choisissez votre nom :</label><br>
    <select id="selectProfGlobal" style="padding:6px; margin:8px 0; width:80%; max-width:300px; border-radius:6px; border:1px solid #ccc;">
      <option value="">-- Choisir --</option>
      <option>Anthony BUNEL</option>
      <option>Arnaud GRASSIN</option>
      <option>Christian SALMERO</option>
      <option>Christelle SOUBOUKOU KIFOULA</option>
      <option>Laurence DINET</option>
      <option>Marion BRETTEVILLE</option>
      <option>S√©bastien GOHIER</option>
      <option>Val√©rie LOPEZ</option>
      <option>Vincent DESGRIPPES</option>
    </select>
  </div>
</div>


  <!-- Section R√©pertoire √âl√®ves -->
  <div class="section" id="sectionRepertoire">
    <h2>R√©pertoire √©l√®ves</h2>
    <div style="overflow-x:auto; margin-top:20px;">
      <table id="repertoireTable" style="width:100%; border-collapse: collapse; border-radius:8px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
        <thead style="background: #ffb629; color:#000; text-align:left;">
          <tr>
            <th style="padding:10px;">Nom</th>
            <th style="padding:10px;">T√©l√©phone</th>
            <th style="padding:10px;">Email</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>
    </div>
    <p id="repertoireMsg" style="color:red; margin-top:10px;"></p>
  </div>

  <!-- Section Planning -->
  <div class="section" id="planning">
    <h2>Planning des salles</h2>

    <label for="selectJour"><strong>S√©lectionnez le jour :</strong></label>
    <select id="selectJour" style="padding:4px; margin-bottom:10px;">
      <option value="Lundi">Lundi</option>
      <option value="Mardi">Mardi</option>
      <option value="Mercredi">Mercredi</option>
      <option value="Jeudi">Jeudi</option>
      <option value="Vendredi">Vendredi</option>
      <option value="Samedi">Samedi</option>
    </select>

    <!-- Indicateur de chargement -->
    <p id="planningLoading" style="font-weight:bold; color:#f39c12; display:none;">Chargement du planning‚Ä¶</p>

    <div id="planningWrapper" style="display:flex; border:1px solid #000; height:700px; overflow-y:auto;">
      <div id="horaires" style="width:50px; border-right:1px solid #000; text-align:right; padding-right:4px; position:relative;"></div>
      <div id="planningContainer" style="display:flex; flex:1; position:relative;"></div>
    </div>
  </div>

  <!-- Section Heures Suppl√©mentaires -->
  <div class="section" id="heuresSup">
    <h2>D√©claration Heures Suppl√©mentaires</h2>
    <p style="color:red; font-weight:bold; margin-bottom:10px;">
      Toute heure effectu√©e en dehors du planning habituel (li√©e √† un √©v√©nement, r√©p√©tition, remplacement, concert, etc.)<br>
      doit √™tre d√©clar√©e dans ce tableau AVANT LE 20 DU MOIS CONCERN√â.<br>
      Seules les heures d√©clar√©es et valid√©es par la direction seront prises en compte pour la paie.
    </p>
    <table id="hsTable">
      <thead>
        <tr><th>Date</th><th>Type</th><th>D√©but</th><th>Fin</th><th>Dur√©e</th><th>Lieu</th><th>Action</th></tr>
      </thead>
      <tbody></tbody>
      <tfoot>
        <tr><td colspan="4">Total</td><td id="totalDuration">0h00</td><td colspan="2"></td></tr>
      </tfoot>
    </table>
    <button id="addRowHs" style="background-color:#ddd; color:#000; border:none; border-radius:4px; padding:6px 12px; cursor:pointer;">+ Ajouter une ligne</button>
    <button id="sendHs" style="background-color:#f39c12; color:white; border:none; border-radius:4px; padding:6px 12px; cursor:pointer;">Envoyer la demande</button>
    <p id="hsLoading" style="display:none;color:#f39c12;font-weight:bold;">‚è≥ Envoi en cours...</p>
    <p id="confirmHs" style="color:green;font-weight:bold;"></p>
  </div>

  <!-- Section Absences -->
  <div class="section" id="absences">
    <h2>Demande d'Absences</h2>
    <p style="color:red; font-weight:bold; margin-bottom:10px;">
      Toute demande d‚Äôautorisation d‚Äôabsence pour convenance personnelle doit √™tre d√©clar√©e dans ce tableau et transmise au minimum 10 JOURS CALENDAIRES avant la date de l‚Äôabsence.<br>
      Toute demande transmise hors d√©lai ne pourra pas √™tre autoris√©e, sauf cas exceptionnel d√ªment justifi√© et valid√© par la direction.<br>
      Aucune absence ne sera consid√©r√©e comme autoris√©e sans d√©claration pr√©alable et validation explicite de la direction.
    </p>
    <table id="absTable">
      <thead>
        <tr>
          <th>Date d'absence</th><th>Cr√©neau</th><th>Date rattrapage</th><th>Cr√©neau rattrapage</th><th>Salle</th><th>Accord</th><th>Action</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
    <button id="addRowAbs" style="background-color:#ddd; color:#000; border:none; border-radius:4px; padding:6px 12px; cursor:pointer;">+ Ajouter une ligne</button>
    <button id="sendAbs" style="background-color:#f39c12; color:white; border:none; border-radius:4px; padding:6px 12px; cursor:pointer;">Envoyer la demande</button>
    <p id="absLoading" style="display:none;color:#f39c12;font-weight:bold;">‚è≥ Envoi en cours...</p>
    <p id="confirmAbs" style="color:green;font-weight:bold;"></p>
  </div>

  <!-- Section Partitions -->
<div class="section" id="partitions">
  <h2>Partitions concert de fin d'ann√©e 2025-2026</h2>

  <div style="overflow-x:auto; margin-top:20px; padding:10px; background:#f9f9f9; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1);">

    <div id="morceauxList">

      <div class="morceau">
        <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">Queen</span> - <span class="titre">The Show Must Go On</span>
</div>


        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/xyBiDDAR#J3pY2Cqfjpt2jye4PcL3k_SkRzZlZPO432rt60a-6mM','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Chorale</span>
              <button onclick="window.open('https://mega.nz/file/crQhBALC#J2YHA1Mw1r7n5wJ3DUa8fi01wlZJ1T72-pGuaQotBB0','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/tzpAwCRA#M6z2fMS6dPcOF2ne4iW_1Eh-UdRKrTYg7xabprV1cPg','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon 1</span>
              <button onclick="window.open('https://mega.nz/file/43gXkLCJ#O3zrcq_FZ1bBLk0VYcE6OgB3I3Fm-LMylL5svpvyEig','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/AvwklLwC#7AF1-csfmhkZ3pNS18IcIUf4RU32jWglgzIoyZRpPKQ','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Drumless</span>
              <button onclick="window.open('https://mega.nz/file/ci5FUAaQ#U88S3XuHlEEPyHen4k98S5I9koMRQiF8pDU-lsaQt-Y','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Instrumentale</span>
              <button onclick="window.open('https://mega.nz/file/Qn5kAaoL#g-DYa8NZLUf4d48etC7NtHPQsrXkdp3o_95vneL3fRM','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

        </div>
      </div>

      <!-- Ajouter d'autres morceaux ici -->

         <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">Shaka Ponk vs Scala & Kolacny Brothers</span> - <span class="titre">Smells Like Teens Spirit</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/8vIF2TxJ#xVN5yq4MiuC201C0wCAOnKRh5iQndrbNXUxKIyNhwE8','_blank')">Voir / T√©l√©charger</button>
            </div>
             <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/I2x0FKyC#kHl0xt9nmcF2ESra5nhz_4cOBgEgEWdqNO_laDq2P6U','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon 1</span>
              <button onclick="window.open('https://mega.nz/file/ZzImVB5T#DkvZBCKC_2BiibrZSggACMHrMy9b4LgeNNUjGOuwc_0','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon 2</span>
              <button onclick="window.open('https://mega.nz/file/53JFGYZD#FjdOOxeXY-D2nmkIxjeOwCqnwJsBRrkiEXH5dy8aaRM','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/t2ACWYZb#qeNMIGcyHuW-gpR2ckQhSlyseAZUtGoDW5b6hjBM4OY','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Instrumentale</span>
              <button onclick="window.open('https://mega.nz/file/MzIXQTLQ#LW_sQtoBpnMyXq9mb4uUw6KH25xRCw8I0BJCY1UP9bQ','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->


        <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">U2</span> - <span class="titre">I Still Haven't Found What I'm Looking For</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/drAHXDyB#jZfmfqUPSqUSCFF0Cei_NXSZk8T7mTLqzttIu_xzsNs','_blank')">Voir / T√©l√©charger</button>
            </div>
            
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/xvQAxIiJ#K23AHWGBkPODIDakIa6N9F67DWWJI4OfVmP8wawjFlI','_blank')">Voir / T√©l√©charger</button>
            </div>
            
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/M7AUSTpL#8w05vsgOWvzGcZd3Y8TLIH9UfwlH6GJD5OUm_-AK4_Y','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Drumless</span>
              <button onclick="window.open('https://mega.nz/file/s2IlSY7Z#DmILMdz4Ug63BGY8Y-ybfOXZmXZhYw-F0tNAUAR5lfg','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Instrumentale</span>
              <button onclick="window.open('https://mega.nz/file/8vJCCTBL#2s_ufuaba0WuHjLeP4-HQCzO7ri8JBWE0O24_lQoPMY','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->



        <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">Hairn</span> - <span class="titre">Let The Sunshine In</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Conducteur</span>
              <button onclick="window.open('https://mega.nz/file/Yixy2CCY#eXoevIypQ5cGTtrjbo8LZLmWCXWRnSeFk8vbhKlFYkc','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/Z2YyjYjI#t-N_lQ_doEtNROcZ3gf1MC5JEKKyer0TCLAL5hFc2SQ','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Soprano</span>
              <button onclick="window.open('https://mega.nz/file/dvBCyDKI#jF97ijq0Tuwu6maIbNA59IjLFOZT4yjznEndl18hPO8','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/EqRhURaI#Y8_fuMjjgNo8YuVhf8sdszWnm2P_g3ZHnRNmGhlGT08','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Fl√ªte</span>
              <button onclick="window.open('https://mega.nz/file/UiQXmDaK#GJ0S62ce3Ld3TfAO2PiNED3lDuC9wMxTNGZ48iAZdHA','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Saxophone Alto</span>
              <button onclick="window.open('https://mega.nz/file/43w2BLbb#rmNSTafzmyJmq5pSqYXJW_yHNtM2oG1UoR2nIrU0Yzc','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Trompette</span>
              <button onclick="window.open('https://mega.nz/file/4yxWnYyY#A9XBuegDWL-pWLUlyX4bBzc3mEKavDVHmXcmLOSyIc4','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/1qgnUSpJ#0rsKWWNlMiSWGQJxkc72TsYnq4HCJDlpZksn8h_W2Po','_blank')">Voir / T√©l√©charger</button>
            </div>
            
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->


        <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">Bourvil</span> - <span class="titre">La Tendresse</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Conducteur</span>
              <button onclick="window.open('https://mega.nz/file/s24lwKBZ#FXvn1ugc7wEuW2t18RQXVFyO7m1aIEssPaUZeE_gV4s','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano+Choeur</span>
              <button onclick="window.open('https://mega.nz/file/AuwljJiD#jcylKk6lobeFzV-1158hSRaa5wAq2k7qFpUHR50INNE','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/pmgi2CCL#dPCkZwIgJpJvniPoPbhSV63_gwmN7UVH1QxGrKHiz2Y','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon</span>
              <button onclick="window.open('https://mega.nz/file/hiIw1awI#ysjVh2_cxWIiXkVHYzBghZPmzKfsMO_LmWEEezEHiRQ','_blank')">Voir / T√©l√©charger</button>
            </div>
             <div class="fichier">
              <span>Fl√ªte 1</span>
              <button onclick="window.open('https://mega.nz/file/ImJXzRjA#AYNdgyOLZTiDib4LRREBeoOxg_smczbje0kQDXbZXYk','_blank')">Voir / T√©l√©charger</button>
            </div>
              <div class="fichier">
              <span>Fl√ªte 2</span>
              <button onclick="window.open('https://mega.nz/file/hqRi2bBQ#BibZxgOznw1wOalxSmHtM7_54-2HwoXySxSsyopWp_A','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Clarinette 1</span>
              <button onclick="window.open('https://mega.nz/file/RmZgia7C#jANcTtp8xQdra879T3F-0ecnaZaHW0EXufK9EAJgR_0','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Clarinette 2</span>
              <button onclick="window.open('https://mega.nz/file/pzIHXBTA#gRG-fMS5a0NUAWl_n5rynjyl9BPPisOFE77y7UvglnM','_blank')">Voir / T√©l√©charger</button>
            </div>
             <div class="fichier">
              <span>Alto</span>
              <button onclick="window.open('https://mega.nz/file/V7IXhLoS#svo1gx-9KIQ-EuhYIKt5pyIr4KaRd6DTBr4RxgFHl8o','_blank')">Voir / T√©l√©charger</button>
            </div>
             <div class="fichier">
              <span>Basse</span>
              <button onclick="window.open('https://mega.nz/file/w7hTASYZ#Wtxfzm7msrwtWHddgjj1nD5hYnnFKbMOP9XHMgy0HYc','_blank')">Voir / T√©l√©charger</button>
            </div>
             <div class="fichier">
              <span>Soprano</span>
              <button onclick="window.open('https://mega.nz/file/U3IgyKoD#ZEdamxaLy22AKxLOBWVzrn7pSSgsa52_xJL8vU4OKto','_blank')">Voir / T√©l√©charger</button>
            </div> 
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/t6g2GDBb#d0yGSt4ZZhcs7jxsPQqWT9Up3r8BHpq-ZXpTgQuk9TQ','_blank')">Voir / T√©l√©charger</button>
            </div>
            
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->



        <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">Annie Lennox</span> - <span class="titre">I Put a Spell On You</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/xyBiDDAR#J3pY2Cqfjpt2jye4PcL3k_SkRzZlZPO432rt60a-6mM','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Chorale</span>
              <button onclick="window.open('https://mega.nz/file/crQhBALC#J2YHA1Mw1r7n5wJ3DUa8fi01wlZJ1T72-pGuaQotBB0','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/tzpAwCRA#M6z2fMS6dPcOF2ne4iW_1Eh-UdRKrTYg7xabprV1cPg','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon 1</span>
              <button onclick="window.open('https://mega.nz/file/43gXkLCJ#O3zrcq_FZ1bBLk0VYcE6OgB3I3Fm-LMylL5svpvyEig','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/AvwklLwC#7AF1-csfmhkZ3pNS18IcIUf4RU32jWglgzIoyZRpPKQ','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Drumless</span>
              <button onclick="window.open('https://mega.nz/file/ci5FUAaQ#U88S3XuHlEEPyHen4k98S5I9koMRQiF8pDU-lsaQt-Y','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Instrumentale</span>
              <button onclick="window.open('https://mega.nz/file/Qn5kAaoL#g-DYa8NZLUf4d48etC7NtHPQsrXkdp3o_95vneL3fRM','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->




        <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">K Pop Deamons Hunters</span> - <span class="titre">Free</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/xyBiDDAR#J3pY2Cqfjpt2jye4PcL3k_SkRzZlZPO432rt60a-6mM','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Chorale</span>
              <button onclick="window.open('https://mega.nz/file/crQhBALC#J2YHA1Mw1r7n5wJ3DUa8fi01wlZJ1T72-pGuaQotBB0','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/tzpAwCRA#M6z2fMS6dPcOF2ne4iW_1Eh-UdRKrTYg7xabprV1cPg','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon 1</span>
              <button onclick="window.open('https://mega.nz/file/43gXkLCJ#O3zrcq_FZ1bBLk0VYcE6OgB3I3Fm-LMylL5svpvyEig','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/AvwklLwC#7AF1-csfmhkZ3pNS18IcIUf4RU32jWglgzIoyZRpPKQ','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Drumless</span>
              <button onclick="window.open('https://mega.nz/file/ci5FUAaQ#U88S3XuHlEEPyHen4k98S5I9koMRQiF8pDU-lsaQt-Y','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Instrumentale</span>
              <button onclick="window.open('https://mega.nz/file/Qn5kAaoL#g-DYa8NZLUf4d48etC7NtHPQsrXkdp3o_95vneL3fRM','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->



        <div class="morceau">
         <div class="morceauTitre" onclick="toggleMorceau(this)">
  <span class="groupe">Henri Salvador</span> - <span class="titre">Le Lion Est Mort ce Soir</span>
</div>

        <div class="morceauContent">

          <div class="onglets">
            <button onclick="showOnglet('partitionsOnglet', this, event)">Partitions</button>
            <button onclick="showOnglet('audiosOnglet', this, event)">Audios</button>
          </div>

          <!-- Contenu Partitions -->
          <div id="partitionsOnglet" style="display:none;">
            <div class="fichier">
              <span>Batterie</span>
              <button onclick="window.open('https://mega.nz/file/xyBiDDAR#J3pY2Cqfjpt2jye4PcL3k_SkRzZlZPO432rt60a-6mM','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Chorale</span>
              <button onclick="window.open('https://mega.nz/file/crQhBALC#J2YHA1Mw1r7n5wJ3DUa8fi01wlZJ1T72-pGuaQotBB0','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Piano</span>
              <button onclick="window.open('https://mega.nz/file/tzpAwCRA#M6z2fMS6dPcOF2ne4iW_1Eh-UdRKrTYg7xabprV1cPg','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Violon 1</span>
              <button onclick="window.open('https://mega.nz/file/43gXkLCJ#O3zrcq_FZ1bBLk0VYcE6OgB3I3Fm-LMylL5svpvyEig','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

          <!-- Contenu Audios -->
          <div id="audiosOnglet" style="display:none;">
            <div class="fichier">
              <span>Version compl√®te</span>
              <button onclick="window.open('https://mega.nz/file/AvwklLwC#7AF1-csfmhkZ3pNS18IcIUf4RU32jWglgzIoyZRpPKQ','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Drumless</span>
              <button onclick="window.open('https://mega.nz/file/ci5FUAaQ#U88S3XuHlEEPyHen4k98S5I9koMRQiF8pDU-lsaQt-Y','_blank')">Voir / T√©l√©charger</button>
            </div>
            <div class="fichier">
              <span>Instrumentale</span>
              <button onclick="window.open('https://mega.nz/file/Qn5kAaoL#g-DYa8NZLUf4d48etC7NtHPQsrXkdp3o_95vneL3fRM','_blank')">Voir / T√©l√©charger</button>
            </div>
          </div>

        </div>
      </div>


          <!-- Ajouter d'autres morceaux ici -->






    </div>
  </div>
</div>


<!-- Section Contacts -->


<div class="section" id="contacts">
  <h2>Contacts</h2>

  <!-- Message de chargement -->
  <div id="contactsLoading" style="font-weight:bold; color:#f39c12; display:none;">‚è≥ Chargement des contacts‚Ä¶</div>

  <!-- Tableau des contacts -->
  <div style="overflow-x:auto; margin-top:20px;">
    <table id="contactsTable" style="width:100%; border-collapse: collapse; border-radius:8px; overflow:hidden; box-shadow:0 2px 5px rgba(0,0,0,0.1);">
      <thead style="background: #ffb629; color:#000; text-align:left;">
        <tr>
          <th style="padding:10px;">Nom</th>
          <th style="padding:10px;">T√©l√©phone</th>
          <th style="padding:10px;">Email</th>
          <th style="padding:10px;">Fonction</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>

  <!-- Message d'erreur -->
  <p id="contactsMsg" style="color:red; margin-top:10px;"></p>
</div>




<!-- Section Documents utiles -->


<section id="documentsUtiles" class="section" style="display:none;">
  <h2>Documents utiles</h2>
  <div class="doc-buttons">
    <a class="btn-doc" href="https://mega.nz/file/RrJXBAzQ#v_YAxkEAH0OolgQs8_lo1vmkaHjv3r2rcR3lsFqIZuc" target="_blank">R√®glement int√©rieur</a>
    <a class="btn-doc" href="https://mega.nz/file/gvBVmb7Y#v_VScH9TxuocV1pMIOEVUK7o8NbSN3105Yig89jlqNI">Formulaire d'emprunt</a>
    </div>
</section>




</div>







  <script>

  // --- Planning ---


  // URL de ton script Google Apps Script (R√©pertoire 2025/2026) 
  const url = "https://script.google.com/macros/s/AKfycbz6PlqatBPAhkBYCojOqvOJ4t6xBnc4FYvO_H5Rh4Ld0Yd_g3y3aVDfM-ircPkTkFaBgQ/exec?action=planning";

const profs = {
  "Val√©rie":   "#A7C7E7",  // bleu ciel pastel
  "Christian": "#CDB4DB",  // violet pastel
  "Christelle":"#B7E4C7",  // vert menthe
  "Anthony":   "#AEC6CF",  // bleu-gris
  "Vincent":   "#E2C2FF",  // lavande
  "Arnaud":    "#E6D3A3",  // beige sable (lisible, pas jaune UI)
  "Laurence":  "#BDE0FE",  // bleu clair
  "Marion":    "#FFADAD",  // rose pastel (remplace le rouge agressif)
  "S√©b":       "#A8DADC"   // turquoise pastel
};



  const salles = ["FM-piano","Batterie","Guitare","Piano 2","Artistes"];
  const startHour = 8;
  const endHour = 22;
  const pxMin = 2.5;

 async function loadPlanning() {
  const day = selectJour.value;
  const loadingMsg = document.getElementById("planningLoading");
  loadingMsg.textContent = "‚è≥ Chargement du planning‚Ä¶";
  loadingMsg.style.display = "block";

  const wrapper = document.getElementById("planningWrapper");

  try {
    const response = await fetch(url);
    const data = await response.json();

    planningContainer.innerHTML = "";
    horaires.innerHTML = "";

    const totalMin = (endHour - startHour) * 60;
    planningContainer.style.height = totalMin * pxMin + "px";
    horaires.style.height = planningContainer.style.height;

    // Colonnes
    salles.forEach(s => {
      const c = document.createElement("div");
      c.className = "salle-column";
      c.dataset.salle = s;
      c.style.flex = "1";
      c.style.borderLeft = "1px solid #000";
      c.style.borderRight = "1px solid #000";
      c.style.position = "relative";
      c.innerHTML = `<div class="salle-header" style="position:sticky; top:0; background:#ffb629; text-align:center; border-bottom:1px solid #000; padding:4px; font-weight:bold; z-index:10;">${s}</div>`;
      for (let i = 0; i < totalMin; i += 15) {
        const l = document.createElement("div");
        l.className = "ligne-interval";
        l.style.position = "absolute";
        l.style.left = "0";
        l.style.right = "0";
        l.style.height = "1px";
        l.style.background = "#eee";
        l.style.top = i * pxMin + "px";
        c.appendChild(l);
      }
      planningContainer.appendChild(c);
    });

    // Horaires
    for (let h = startHour; h <= endHour; h++) {
      const d = document.createElement("div");
      d.className = "heure";
      d.style.position = "absolute";
      d.style.top = (h - startHour) * 60 * pxMin + "px";
      d.style.width = "100%";
      d.style.fontSize = "12px";
      d.innerText = h + ":00";
      horaires.appendChild(d);
    }

    // Cours
    data.forEach(c => {
      if (c.jour !== day || !salles.includes(c.salle)) return;

      const d = new Date(c.horaire);
      const min = d.getHours() * 60 + d.getMinutes();
      const top = (min - startHour * 60) * pxMin;

      let dur = 30;
      if (c.type === "collectif") {
        const n = c.cours.toLowerCase();
        if (n.includes("chorale")) dur = 120;
        else if (n.includes("√©veil") || n.includes("eveil")) dur = 45;
        else dur = 60;
      }

      const b = document.createElement("div");
      b.className = "cours";
      b.style.position = "absolute";
      b.style.left = "4px";
      b.style.right = "4px";
      b.style.top = top + "px";
      b.style.height = dur * pxMin + "px";
      b.style.borderRadius = "4px";
      b.style.border = "1px solid #000";
      b.style.padding = "4px";
      b.style.fontSize = "12px";
      b.style.display = "flex";
      b.style.flexDirection = "column";
      b.style.justifyContent = "center";
      b.style.alignItems = "center";
      b.style.textAlign = "center";
      b.style.boxSizing = "border-box";

      b.style.backgroundColor = c.prof && profs[c.prof] ? profs[c.prof] : "#ddd";
      b.innerHTML =
        (c.type === "collectif" ? c.cours : c.eleve) +
        (c.prof ? `<div class="prof" style="font-style:italic; color:#444; font-size:11px;">${c.prof}</div>` : "");

      document.querySelector(`[data-salle='${c.salle}']`).appendChild(b);
    });

    // Scroll automatique vers le premier cours
    setTimeout(() => {
      const cours = wrapper.querySelectorAll(".cours");
      if (!cours.length) return;

      let minTop = Infinity;
      cours.forEach(c => {
        minTop = Math.min(minTop, c.offsetTop);
      });

      wrapper.scrollTop = Math.max(0, minTop - 40);
    }, 50);

    // üîπ Message succ√®s
    loadingMsg.textContent = "‚úÖ Planning charg√© avec succ√®s";
    setTimeout(() => (loadingMsg.style.display = "none"), 1500);

  } catch (err) {
    loadingMsg.textContent = "‚ùå Erreur lors du chargement : " + err;
    console.error(err);
    setTimeout(() => (loadingMsg.style.display = "none"), 3000);
  }
}




  selectJour.onchange = loadPlanning;
  loadPlanning();
  </script>
</div>

<script>





document.addEventListener("DOMContentLoaded", () => {

// ================================
// Mapping affichage ‚Üî GAS
// ================================
const profMap = {
  "Anthony BUNEL": "Anthony",
  "Arnaud GRASSIN": "Arnaud",
  "Christian SALMERO": "Christian",
  "Christelle SOUBOUKOU KIFOULA": "Christelle",
  "Laurence DINET": "Laurence",
  "Marion BRETTEVILLE": "Marion",
  "S√©bastien GOHIER": "S√©b",
  "Val√©rie LOPEZ": "Val√©rie",
  "Vincent DESGRIPPES": "Vincent"
};




// --- Sections ---


window.showSection = section => {
  const prof = document.getElementById("selectProfGlobal").value;

  // üîπ Bloquer compl√®tement si aucun prof n'est choisi (sauf accueil)
  if(!prof && section !== 'accueil') {
    alert("Veuillez choisir un professeur pour acc√©der √† cette section !");
    return; // ‚Üê stoppe la fonction
  }

  // Masquer toutes les sections
  document.querySelectorAll('.section').forEach(s => s.style.display = 'none');

  // Afficher la section demand√©e
  document.getElementById(section).style.display = 'block';

  // üîπ Afficher ou cacher le select de prof
  const profSelector = document.getElementById('profSelectorWrapper');
  profSelector.style.display = (section === 'accueil') ? 'block' : 'none';
};

// --- Logo cliquable pour revenir √† l'accueil ---
const logo = document.querySelector(".sidebar img");
logo.style.cursor = 'pointer';
logo.addEventListener("click", () => {
  // Affiche la page d'accueil avec le message et le select
  showSection('accueil');
});

// --- Faire dispara√Ætre le message d‚Äôaccueil automatiquement d√®s qu‚Äôun prof est choisi ---
document.getElementById("selectProfGlobal").addEventListener("change", () => {
  const prof = document.getElementById("selectProfGlobal").value;
  if(prof) document.getElementById("accueilMessage").style.display = "flex";
});

// --- Au chargement de la page, afficher directement l'accueil ---
document.addEventListener("DOMContentLoaded", () => {
  showSection('accueil');
});







// --- R√©pertoire ---



const repertoireTableBody = document.querySelector("#repertoireTable tbody");
const repertoireMsg = document.getElementById("repertoireMsg");

function formatPhone(phone){
  phone = phone.toString().trim();
  if(!phone.startsWith("0")) phone = "0"+phone;
  return phone.replace(/(\d{2})(?=\d)/g,'$1 ');
}

function loadRepertoire(profName) {
  repertoireTableBody.innerHTML = "";
  repertoireMsg.textContent = "";

  if (!profName) return;

  // Affichage du message "Chargement en cours‚Ä¶"
  repertoireMsg.style.color = "#f39c12";
  repertoireMsg.textContent = "‚è≥ Chargement en cours‚Ä¶";




  // URL de ton script Google Apps Script (R√©pertoire 2025/2026)
  const url = "https://script.google.com/macros/s/AKfycbz6PlqatBPAhkBYCojOqvOJ4t6xBnc4FYvO_H5Rh4Ld0Yd_g3y3aVDfM-ircPkTkFaBgQ/exec?profName=" + encodeURIComponent(profName);

  fetch(url)
    .then(r => r.json())
    .then(data => {
      if (data.error) {
        repertoireMsg.style.color = "red";
        repertoireMsg.textContent = data.error;
        return;
      }
      if (data.length === 0) {
        repertoireMsg.style.color = "red";
        repertoireMsg.textContent = "Aucun √©l√®ve trouv√© pour " + profName;
        return;
      }

      // Supprimer les doublons d'√©l√®ves (m√™me nom et email)
      const seen = new Set();
      const uniqueEleves = data.filter(eleve => {
        const key = eleve.Nom + "|" + eleve.Email;
        if (seen.has(key)) return false;
        seen.add(key);
        return true;
      });

      uniqueEleves.forEach((eleve, i) => {
        const tr = document.createElement("tr");
        tr.style.backgroundColor = i % 2 === 0 ? "#fff" : "#f9f9f9";
        tr.innerHTML = `
          <td style="padding:8px;border-bottom:1px solid #ddd;">${eleve.Nom}</td>
          <td style="padding:8px;border-bottom:1px solid #ddd;">${formatPhone(eleve.T√©l√©phone)}</td>
          <td style="padding:8px;border-bottom:1px solid #ddd;">
            <a href="mailto:${eleve.Email}">${eleve.Email}</a>
          </td>`;
        repertoireTableBody.appendChild(tr);
      });

      // Tout est charg√© ‚Üí masquer le message
      repertoireMsg.textContent = "";
    })
    .catch(err => {
      repertoireMsg.style.color = "red";
      repertoireMsg.textContent = "Erreur lors du chargement : " + err;
    });
}




document.getElementById("selectProfGlobal").addEventListener("change", e=>{
  const profAffiche = e.target.value;
  const prof = profMap[profAffiche];
  loadRepertoire(prof);
});



// --- Heures Sup ---



const typesEvenement = ["Concert","R√©p√©tition","Autre"];
function formatDuration(h,m){ return `${h}h${m.toString().padStart(2,'0')}`; }
function calculateDuration(start,end){
  if(!start||!end) return "0h00";
  const [h1,m1]=start.split(":").map(Number);
  const [h2,m2]=end.split(":").map(Number);
  let total=(h2*60+m2)-(h1*60+m1); if(total<0) total=0;
  return formatDuration(Math.floor(total/60), total%60);
}
function updateDurHs(){
  let totalMins=0;
  document.querySelectorAll("#hsTable tbody tr").forEach(tr=>{
    const start=tr.querySelector(".debut").value;
    const end=tr.querySelector(".fin").value;
    const dur=calculateDuration(start,end);
    tr.querySelector(".duree").textContent=dur;
    const [h,m]=dur.split("h").map(Number);
    totalMins+=h*60+m;
  });
  document.getElementById("totalDuration").textContent=formatDuration(Math.floor(totalMins/60), totalMins%60);
}
function addRowHs(data={}){ 
  const tbody=document.querySelector("#hsTable tbody"); 
  const tr=document.createElement("tr");
  tr.innerHTML=`
    <td><input type="date" class="date" value="${data.date||''}"></td>
    <td><select class="type">${typesEvenement.map(t=>`<option value="${t}" ${t===data.type?'selected':''}>${t}</option>`).join('')}</select></td>
    <td><input type="time" class="debut" value="${data.debut||''}"></td>
    <td><input type="time" class="fin" value="${data.fin||''}"></td>
    <td class="duree">0h00</td>
    <td><input type="text" class="lieu" value="${data.lieu||''}"></td>
    <td><button type="button" class="deleteBtn">X</button></td>`;
  tbody.appendChild(tr);
  tr.querySelector(".debut").addEventListener("input",updateDurHs);
  tr.querySelector(".fin").addEventListener("input",updateDurHs);
  tr.querySelector(".deleteBtn").addEventListener("click",()=>{tr.remove(); updateDurHs();});
  updateDurHs();
}
document.getElementById("addRowHs").addEventListener("click",()=>addRowHs());
addRowHs(); // premi√®re ligne

// --- Envoi Heures Suppl√©mentaires ---

document.getElementById("sendHs").addEventListener("click", ()=>{
  const profAffiche = document.getElementById("selectProfGlobal").value.trim();
  const nomProfHs = profMap[profAffiche];
  if(!nomProfHs){ alert("Indiquez le nom du professeur !"); return; }

  const tbody = document.querySelector("#hsTable tbody");
  const lignes = [];

  tbody.querySelectorAll("tr").forEach(tr=>{
    lignes.push({
      date: tr.querySelector(".date")?.value || "",
      type: tr.querySelector(".type")?.value || "",
      debut: tr.querySelector(".debut")?.value || "",
      fin: tr.querySelector(".fin")?.value || "",
      duree: tr.querySelector(".duree")?.textContent || "",
      lieu: tr.querySelector(".lieu")?.value || ""
    });
  });

  const total = document.getElementById("totalDuration").textContent;
  const loadingMsg = document.getElementById("hsLoading");
  loadingMsg.style.display = "block";          // üîπ afficher "envoi en cours"
  document.getElementById("confirmHs").textContent = ""; // vider ancien message




  // URL de ton script Google Apps Script (Heures suppl√©mentaires) 
  
  fetch("https://script.google.com/macros/s/AKfycbyoEkd0NtmfVYRaSujaVeM_wfiEbZCjfJgzTLuKx4a8SJgD47dh9zWGfOR8crss2fk9/exec", {
    method: "POST",
    body: JSON.stringify({nomProf:nomProfHs,lignes,total})
  })
  .then(res => res.json())
  .then(res => {
    loadingMsg.style.display = "none";  // üîπ masquer "envoi en cours"
    document.getElementById("confirmHs").textContent = res.message || "Heures sup envoy√©es avec succ√®s";
    tbody.innerHTML = "";
    addRowHs(); // remettre une ligne vide
  })
  .catch(err => {
    loadingMsg.style.display = "none";  // üîπ masquer m√™me en erreur
    document.getElementById("confirmHs").textContent = "Erreur : " + err;
  });
});




// --- Absences ---



const sallesAbs = ["FM/Piano","Guitare","Batterie","Piano 2","Artistes","Salle des f√™tes Moult"];

function addRowAbs(data={}) {
  const tbody = document.querySelector("#absTable tbody");
  const tr = document.createElement("tr");

  tr.innerHTML = `
    <td><input type="date" class="dateAbs" value="${data.dateAbs||''}"></td>
    <td><input type="text" class="creneauAbs" placeholder="Ex: 16h30-18h30" value="${data.creneauAbs||''}"></td>
    <td><input type="date" class="dateRatt" value="${data.dateRatt||''}"></td>
    <td><input type="text" class="creneauRatt" placeholder="Ex: 16h30-18h30" value="${data.creneauRatt||''}"></td>
    <td><select class="salle">${sallesAbs.map(s=>`<option value="${s}" ${s===data.salle?'selected':''}>${s}</option>`).join('')}</select></td>
    <td><input type="checkbox" class="accord" ${data.accord?'checked':''}></td>
    <td><button type="button" class="deleteBtn">X</button></td>
  `;

  tbody.appendChild(tr);

  // Supprimer ligne
  tr.querySelector(".deleteBtn").addEventListener("click",()=> tr.remove());
}

// Ajouter ligne Absence

document.getElementById("addRowAbs").addEventListener("click",()=>addRowAbs());
addRowAbs(); // premi√®re ligne

// --- Envoi Absences ---

document.getElementById("sendAbs").addEventListener("click", ()=>{
  const profAffiche = document.getElementById("selectProfGlobal").value.trim();
  const nomProfAbs = profMap[profAffiche];
  if(!nomProfAbs){ alert("Indiquez le nom du professeur !"); return; }

  const tbody = document.querySelector("#absTable tbody");
  const lignes = [];

  tbody.querySelectorAll("tr").forEach(tr=>{
    lignes.push({
      dateAbs: tr.querySelector(".dateAbs")?.value || "",
      creneauAbs: tr.querySelector(".creneauAbs")?.value || "",
      dateRatt: tr.querySelector(".dateRatt")?.value || "",
      creneauRatt: tr.querySelector(".creneauRatt")?.value || "",
      salle: tr.querySelector(".salle")?.value || "",
      accord: tr.querySelector(".accord")?.checked || false
    });
  });

  const loadingMsg = document.getElementById("absLoading");
  loadingMsg.style.display = "block";   // üîπ afficher "envoi en cours"
  document.getElementById("confirmAbs").textContent = ""; // vider ancien message

  

  // URL de ton script Google Apps Script (Demande d'autorisation d'absence) 

  fetch("https://script.google.com/macros/s/AKfycbxB4nTAyo-dbK89U1UNGkCp9n_vwBf5MDln9s2-dVPW6Qh4X2HNcp6fXttJFuxpOMD0/exec", {
    method: "POST",
    body: JSON.stringify({nomProf:nomProfAbs,lignes})
  })
  .then(res => res.json())
  .then(res => {
    loadingMsg.style.display = "none"; // üîπ masquer "envoi en cours"
    document.getElementById("confirmAbs").textContent = res.message || "PDF envoy√© avec succ√®s";
    tbody.innerHTML = "";
    addRowAbs(); // remettre une ligne vide
  })
  .catch(err => {
    loadingMsg.style.display = "none"; // üîπ masquer "envoi en cours" m√™me en erreur
    document.getElementById("confirmAbs").textContent = "Erreur : " + err;
  });
});



// --- Partitions / Onglets morceaux ---


window.toggleMorceau = function(el) {
  const content = el.nextElementSibling;
  if (!content) return;

  document.querySelectorAll('.morceauContent').forEach(c=>{
    if(c!==content) c.style.display='none';
  });

  content.style.display = content.style.display==='block' ? 'none' : 'block';

  if(content.style.display==='block') {
    content.querySelectorAll('.onglets button').forEach(b=>b.classList.remove('active'));
    content.querySelectorAll('#partitionsOnglet, #audiosOnglet').forEach(d=>d.style.display='none');
  }
};

window.showOnglet = function(id, btn, event) {
  event.stopPropagation();
  const parent = btn.closest('.morceauContent');
  parent.querySelectorAll('#partitionsOnglet, #audiosOnglet').forEach(d=>d.style.display='none');
  parent.querySelector('#'+id).style.display='block';
  parent.querySelectorAll('.onglets button').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
};



// --- Contacts ---
function loadContacts() {
  const contactsTableBody = document.querySelector("#contactsTable tbody");
  const loadingMsg = document.getElementById("contactsLoading");
  const contactsMsg = document.getElementById("contactsMsg");

  contactsTableBody.innerHTML = "";
  contactsMsg.textContent = "";
  loadingMsg.style.display = "block";



  // URL de ton script Google Apps Script (R√©pertoire 2025/2026)
  const url = "https://script.google.com/macros/s/AKfycbz6PlqatBPAhkBYCojOqvOJ4t6xBnc4FYvO_H5Rh4Ld0Yd_g3y3aVDfM-ircPkTkFaBgQ/exec?action=contacts";

  // Fonction pour remettre le 0 devant le t√©l√©phone
  function formatPhone(phone) {
    phone = phone.toString().trim();
    if (!phone.startsWith("0")) phone = "0" + phone;
    return phone.replace(/(\d{2})(?=\d)/g, "$1 ");
  }

  fetch(url)
    .then(r => r.json())
    .then(data => {
      loadingMsg.style.display = "none";
      if (data.error) {
        contactsMsg.textContent = data.error;
        return;
      }

      // üîπ Trier par NOM (dernier mot du champ "Nom")
data.sort((a, b) => {
  const nomA = a.Nom.trim().split(" ").pop().toLowerCase();
  const nomB = b.Nom.trim().split(" ").pop().toLowerCase();
  return nomA.localeCompare(nomB, 'fr', { sensitivity: 'base' });
});


      data.forEach(contact => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td style="padding:8px;border-bottom:1px solid #ddd;">${contact.Nom}</td>
          <td style="padding:8px;border-bottom:1px solid #ddd;">${formatPhone(contact.T√©l√©phone)}</td>
          <td style="padding:8px;border-bottom:1px solid #ddd;">
            <a href="mailto:${contact.Email}">${contact.Email}</a>
          </td>
          <td style="padding:8px;border-bottom:1px solid #ddd;">${contact.Fonction}</td>
        `;
        contactsTableBody.appendChild(tr);
      });
    })
    .catch(err => {
      loadingMsg.style.display = "none";
      contactsMsg.textContent = "‚ùå Erreur lors du chargement : " + err;
      console.error(err);
    });
}



document.querySelector(".menu-item[onclick*='contacts']").addEventListener("click", () => {
  showSection("contacts");  // affiche la section Contacts
  loadContacts();            // charge les contacts depuis Google Sheets
});






}); // <-- fin DOMContentLoaded
</script>

</body>
</html>
